# Page Builder

A visual drag-and-drop page builder for OnePageCMS that allows you to create pages without writing code.

## Features

- **Drag-and-Drop Interface**: Intuitive two-column layout with block palette and canvas
- **Visual Block Editor**: Edit block properties through a user-friendly modal interface
- **Page Management**: Create, save, load, and delete pages
- **Live Preview**: Preview pages in desktop, tablet, and mobile viewports
- **All Blocks Supported**: Works with all OnePageCMS blocks (container, button, card, hero, etc.)

## Usage

### Accessing the Page Builder

Navigate to the page builder by visiting:
```
/framework-addons/page-builder/page-builder.php
```

Or create a link in your navigation:
```php
<a href="/framework-addons/page-builder/page-builder.php">Page Builder</a>
```

### Creating a New Page

1. Click the **New Page** button in the top menu
2. Enter a page name (lowercase letters, numbers, and hyphens only)
3. Click **Create Page**

### Building Your Page

1. **Drag blocks** from the left sidebar to the canvas
2. **Click the edit icon** (pencil) on any block to configure its properties
3. **Reorder blocks** by clicking and dragging the move icon (grip)
4. **Delete blocks** by clicking the trash icon

### Saving Your Page

1. Click the **Save** button in the top menu
2. The page will be saved to the `/pages` directory as a `.php` file
3. Your page will be accessible at `/?page=your-page-name`

### Loading an Existing Page

1. Select a page from the dropdown in the top menu
2. The page will load with all its blocks in the canvas
3. You can now edit and save changes

### Previewing Your Page

1. Click the **Preview** button
2. Choose your viewport size:
   - **Desktop** (full width)
   - **Tablet** (768px)
   - **Mobile** (375px)
3. The preview shows how your page will look

### Deleting a Page

1. Load the page you want to delete
2. Click the **Delete** button
3. Confirm the deletion

## File Structure

```
framework-addons/page-builder/
├── page-builder.php        # Main interface
├── page-builder.css        # Styles
├── page-builder.js         # Drag-drop functionality
├── page-builder-api.php    # Backend API (save/load/delete)
└── README.md              # This file
```

## Available Blocks

All OnePageCMS blocks are available in the builder:

- **Container** - Flexible container for wrapping content
- **Text View** - Paragraphs, headings, quotes, code blocks
- **Button** - Call-to-action buttons with various styles
- **Card** - Content cards with title, body, and footer
- **Accordion** - Collapsible content sections
- **Alert** - Notification messages
- **Form** - Input forms with various field types
- **Hero** - Large banner sections
- **Slider** - Image carousels
- **Menu** - Navigation menus
- **List** - Ordered and unordered lists
- **Media** - Images and icons
- **Social** - Social media buttons
- **Logo** - Logo display
- **Markdown** - Markdown content rendering

## Container Blocks

The **Container** block is special - it can hold other blocks inside it. This allows you to:
- Group related content
- Create complex layouts
- Apply consistent styling to multiple blocks

## Technical Details

### How Pages Are Saved

Pages are saved as PHP files in the `/pages` directory. Each file contains:
1. Page metadata (title, description)
2. Block data stored as JSON in a comment (for re-editing)
3. PHP code that renders the blocks using block functions

Example generated page:
```php
<?php
/**
 * Page: About
 * Generated by Page Builder
 * 
 * PAGE_BUILDER_DATA: {"blocks":[...]}
 */

set_page_meta([
    'title' => 'About',
    'description' => 'Page created with Page Builder'
]);
?>

<article class="page-content">
    <h1>About</h1>

    <?php
    echo block_hero([
        'title' => 'Welcome',
        'subtitle' => 'Learn more about us'
    ]);
    ?>
</article>
```

### API Endpoints

The `page-builder-api.php` file handles three operations:

**Load Page** (GET)
```
GET /framework-addons/page-builder/page-builder-api.php?action=load&page=about
```

**Save Page** (POST)
```json
{
  "action": "save",
  "pageName": "about",
  "blocks": [...]
}
```

**Delete Page** (POST)
```json
{
  "action": "delete",
  "pageName": "about"
}
```

## Security

- Page names are sanitized to prevent directory traversal
- Only alphanumeric characters and hyphens are allowed in page names
- All user input is escaped when generating PHP code

## Limitations

- Container nesting is currently simplified
- Preview shows block data rather than fully rendered blocks (can be enhanced)
- Some complex block configurations may require manual editing

## Future Enhancements

Potential improvements:
- Real-time preview rendering
- Undo/redo functionality
- Block templates and presets
- Duplicate block feature
- Export/import page templates
- Nested container support with visual indicators
- Keyboard shortcuts
- Block search/filter

## Browser Compatibility

The page builder uses modern web APIs and works best in:
- Chrome/Edge 90+
- Firefox 88+
- Safari 14+

## Support

For issues or questions, refer to the main OnePageCMS documentation.
